import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{o as p,c as e,f as a,a as s,b as n}from"./app-daf6f9ff.js";const l="/assets/image/04Modeling/DE_intro-17_17_29.png",o="/assets/image/04Modeling/DE_intro-17_31_12.png",c="/assets/image/04Modeling/DE_intro-17_32_22.png",i={},u=a(`<h1 id="differentialequations建模方法" tabindex="-1"><a class="header-anchor" href="#differentialequations建模方法" aria-hidden="true">#</a> DifferentialEquations建模方法</h1><p>!!! tip<br> Contents：建模、DE</p><pre><code>Contributor: YJY

Email:522432938@qq.com

如有错误，请批评指正。
</code></pre><p>!!! note</p><pre><code>DE = DifferentialEquations.jl

[DifferentialEquations.jl](https://diffeq.sciml.ai/dev/)为处理时间微分的求解建模工具包。
</code></pre><h2 id="浅谈建模内涵" tabindex="-1"><a class="header-anchor" href="#浅谈建模内涵" aria-hidden="true">#</a> 浅谈建模内涵</h2><p>在研究各类系统时（上至电力、能源系统、交通系统，下至RC电路、水利管网系统），当我们需要对系统进行处理时，我们都会一件相同的事情——把系统抽象成我们能够处理的对象！</p><p>从发现问题到获得计算结果，在现代计算科学中一般分为两步：</p><ol><li>把问题抽象可量化、可处理的数学问题</li><li>把数学问题设计成可用计算机处理与计算的可计算问题</li></ol><p>在这个过程中，大脑在这个过程充当了“解释器”的角色。把实际的问题层层抽象，最后让问题变得可计算。不得不感叹，人类“编译”能力之强大。也许人类在计算速度上远远不及计算机。但在深度与广度层面，远远超过计算机。</p><p>从前牛顿等巨人的时代开始，科学家研究的主体内容，主要是是第一步的内容。近40年，计算机科学技术呈爆炸式增长。依托于计算机，社会生产的智能化日益提高。于是基于第2步的问题也发展出许多学科分支，作为科研领域重要的方向之一。</p><p>这是一件很奇妙的事情，巨量1与0的加减运算产生了无穷的能力！就好像神经元虽然简单，只要数量够，也能组合成产生无数想法的大脑！</p><p>言归正传，在第一步中，描述对象的数学形式有微分方程（组）、代数方程（组）、图等等。针对对象进行计算的数学形式有求解方程问题、寻优问题、计算图等等。DifferentialEquations.jl就是处理基于时间微分的微分方程（组）求解软件包！</p><h2 id="de使用实例" tabindex="-1"><a class="header-anchor" href="#de使用实例" aria-hidden="true">#</a> DE使用实例</h2><p>现有洛伦兹方程为例：</p>`,15),r=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mfrac",null,[s("mrow",null,[s("mi",null,"d"),s("mi",null,"x")]),s("mrow",null,[s("mi",null,"d"),s("mi",null,"t")])]),s("mo",null,"="),s("mi",null,"σ"),s("mo",{stretchy:"false"},"("),s("mi",null,"y"),s("mo",null,"−"),s("mi",null,"x"),s("mo",{stretchy:"false"},")"),s("mspace",{linebreak:"newline"}),s("mfrac",null,[s("mrow",null,[s("mi",null,"d"),s("mi",null,"y")]),s("mrow",null,[s("mi",null,"d"),s("mi",null,"t")])]),s("mo",null,"="),s("mi",null,"x"),s("mo",{stretchy:"false"},"("),s("mi",null,"ρ"),s("mo",null,"−"),s("mi",null,"z"),s("mo",{stretchy:"false"},")"),s("mo",null,"−"),s("mi",null,"y"),s("mspace",{linebreak:"newline"}),s("mfrac",null,[s("mrow",null,[s("mi",null,"d"),s("mi",null,"z")]),s("mrow",null,[s("mi",null,"d"),s("mi",null,"t")])]),s("mo",null,"="),s("mi",null,"x"),s("mi",null,"y"),s("mo",null,"−"),s("mi",null,"β"),s("mi",null,"z")]),s("annotation",{encoding:"application/x-tex"},"\\frac{dx}{dt} = \\sigma(y-x) \\\\ \\frac{dy}{dt} = x(\\rho-z)-y \\\\ \\frac{dz}{dt} = xy - \\beta z ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0574em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3714em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"d"),s("span",{class:"mord mathnormal"},"t")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"d"),s("span",{class:"mord mathnormal"},"x")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"σ"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mclose"},")")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0574em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3714em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"d"),s("span",{class:"mord mathnormal"},"t")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"d"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"ρ"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.04398em"}},"z"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0574em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3714em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"d"),s("span",{class:"mord mathnormal"},"t")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"d"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.04398em"}},"z")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7778em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05278em"}},"β"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.04398em"}},"z")])])])])],-1),m=a(`<p>微分方程在DifferentialEquations.jl中含有5个要素：</p><ul><li>方程描述</li><li>求解时间域</li><li>初值（边界条件）</li><li>方程参数</li><li>问题类型</li></ul><hr><p>在方程定义中，有4个参数：</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code><span class="token keyword">function</span> lorenz<span class="token operator">!</span><span class="token punctuation">(</span>du<span class="token punctuation">,</span>u<span class="token punctuation">,</span>p<span class="token punctuation">,</span>t<span class="token punctuation">)</span>
    du<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    du<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    du<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，</p><ul><li>du为微分变量向量</li><li>u为变量向量</li><li>p为参数</li><li>t为时间变量</li></ul><hr><p>剩下要素的定义：</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code>p <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10.0</span><span class="token punctuation">,</span><span class="token number">28.0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">]</span>
u0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">;</span><span class="token number">0.0</span><span class="token punctuation">;</span><span class="token number">0.0</span><span class="token punctuation">]</span>
tspan <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">100.0</span><span class="token punctuation">)</span>
prob <span class="token operator">=</span> ODEProblem<span class="token punctuation">(</span>lorenz<span class="token operator">!</span><span class="token punctuation">,</span>u0<span class="token punctuation">,</span>tspan<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，</p><ul><li>p为参数</li><li>u0变量的初始值</li><li>tspan为求解时间域</li><li>prob为通过方法ODEProblem()定义的ODE问题</li></ul><p>!!! tip<br> ODEProblem = Ordinary Differential Equations Problem(常微分方程)</p><pre><code>\`\`\`math
\\begin{array}{l}
\\frac{d x}{d t}=\\sigma(y-x) \\\\
\\frac{d y}{d t}=x(\\rho-z)-y \\\\
\\frac{d z}{d t}=x y-\\beta z
\\end{array}
\`\`\`

除此之外，还有：

DAEProblem = Differential Algebraic Equations Problem（微分代数方程）

\`\`\`math
\\begin{aligned}\\frac{d y_{1}}{d t} &amp;=-0.04 y_{1}+10^{4} y_{2} y_{3} \\\\\\frac{d y_{2}}{d t} &amp;=0.04 y_{1}-10^{4} y_{2} y_{3}-3 * 10^{7} y_{2}^{2} \\\\1 &amp;=y_{1}+y_{2}+y_{3}\\end{aligned}
\`\`\`

DDEProblem = Delay Differential Equations Problem（随机微分）

\`\`\`math
\\begin{aligned}
d x_{0} &amp;=\\frac{v_{0}}{1+\\beta_{0}\\left(x_{2}(t-\\tau)\\right)^{2}}\\left(p_{0}-q_{0}\\right) x_{0}(t)-d_{0} x_{0}(t) \\\\d x_{1} &amp;=\\frac{v_{0}}{1+\\beta_{0}\\left(x_{2}(t-\\tau)\\right)^{2}}\\left(1-p_{0}+q_{0}\\right) x_{0}(t) \\\\&amp;+\\frac{v_{1}}{1+\\beta_{1}\\left(x_{2}(t-\\tau)\\right)^{2}}\\left(p_{1}-q_{1}\\right) x_{1}(t)-d_{1} x_{1}(t) \\\\d x_{2} &amp;=\\frac{v_{1}}{1+\\beta_{1}\\left(x_{2}(t-\\tau)\\right)^{2}}\\left(1-p_{1}+q_{1}\\right) x_{1}(t)-d_{2} x_{2}(t)\\end{aligned}
\`\`\`

更多方程种类可查官方文档。
</code></pre><hr><p>求解并画图</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code>sol <span class="token operator">=</span> solve<span class="token punctuation">(</span>prob<span class="token punctuation">,</span> Tsit5<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>sol<span class="token punctuation">,</span>vars<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+l+`" alt="图 4" tabindex="0" loading="lazy"><figcaption>图 4</figcaption></figure><p>全部代码：</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code><span class="token keyword">using</span> DifferentialEquations<span class="token punctuation">,</span>Plots
<span class="token keyword">function</span> lorenz<span class="token operator">!</span><span class="token punctuation">(</span>du<span class="token punctuation">,</span>u<span class="token punctuation">,</span>p<span class="token punctuation">,</span>t<span class="token punctuation">)</span>
        du<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        du<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
        du<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
p <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10.0</span><span class="token punctuation">,</span><span class="token number">28.0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">]</span>
u0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">;</span><span class="token number">0.0</span><span class="token punctuation">;</span><span class="token number">0.0</span><span class="token punctuation">]</span>
tspan <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">100.0</span><span class="token punctuation">)</span>
prob <span class="token operator">=</span> ODEProblem<span class="token punctuation">(</span>lorenz<span class="token operator">!</span><span class="token punctuation">,</span>u0<span class="token punctuation">,</span>tspan<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
sol <span class="token operator">=</span> solve<span class="token punctuation">(</span>prob<span class="token punctuation">,</span> Tsit5<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>sol<span class="token punctuation">,</span>vars<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="de的callback特性" tabindex="-1"><a class="header-anchor" href="#de的callback特性" aria-hidden="true">#</a> DE的Callback特性</h2><p>Callback的含义为，当系统运行到某个状态时，人为介入改变系统参量的值，随后继续求解。</p><p>下面以弹球系统为例，介绍Callback的用法。</p>`,24),k=s("p",null,[n("弹球系统的特点是，当弹球碰到地面时，需要弹起。所以在模拟弹球系统时，需要考虑求解过程中速度的方法变化，这时候就用到callback。碰地的数学的描述为，弹球速度变量变为它的相反数。也就是说当弹球高度"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"x")]),s("annotation",{encoding:"application/x-tex"},"x")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"x")])])]),n("变为0时，速度"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"u")]),s("annotation",{encoding:"application/x-tex"},"u")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"u")])])]),n("需要变成"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mo",null,"−"),s("mi",null,"u")]),s("annotation",{encoding:"application/x-tex"},"-u")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"−"),s("span",{class:"mord mathnormal"},"u")])])]),n("。")],-1),d=s("p",null,"其数学表达为：",-1),b=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"x"),s("mo",{mathvariant:"normal",lspace:"0em",rspace:"0em"},"′")]),s("mo",null,"="),s("mi",null,"v"),s("mspace",{linebreak:"newline"}),s("msup",null,[s("mi",null,"v"),s("mo",{mathvariant:"normal",lspace:"0em",rspace:"0em"},"′")]),s("mo",null,"="),s("mo",null,"−"),s("mi",null,"g")]),s("annotation",{encoding:"application/x-tex"},"x' = v \\\\ v' = -g ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8019em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"x"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"′")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8019em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"′")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7778em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},"−"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g")])])])])],-1),h=a(`<hr><p>DE问题构建：</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code><span class="token keyword">function</span> f<span class="token punctuation">(</span>du<span class="token punctuation">,</span>u<span class="token punctuation">,</span>p<span class="token punctuation">,</span>t<span class="token punctuation">)</span>
    du<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    du<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>p
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，</p><ul><li>u1为x，即弹球高度</li><li>u2为v，即弹球速度</li></ul><hr><p>建立Callback函数：</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code><span class="token keyword">function</span> condition<span class="token punctuation">(</span>u<span class="token punctuation">,</span>t<span class="token punctuation">,</span>integrator<span class="token punctuation">)</span> <span class="token comment"># Event when event_f(u,t) == 0</span>
    u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
<span class="token keyword">function</span> affect<span class="token operator">!</span><span class="token punctuation">(</span>integrator<span class="token punctuation">)</span>
integrator<span class="token punctuation">.</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>integrator<span class="token punctuation">.</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
cb <span class="token operator">=</span> ContinuousCallback<span class="token punctuation">(</span>condition<span class="token punctuation">,</span>affect<span class="token operator">!</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>condition</code>为系统调用callback时应该满足的条件，默认为函数返回值为0（false）时的情况。即<code>u[1]=0</code>。<br><code>affect!</code>为系统调用callback时的处理动作，这里为将速度变负。</p><hr><p>定义剩余要素并求解，<strong>在solve中需要传递callback</strong>。</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code>u0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">50.0</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">]</span>
tspan <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">15.0</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> <span class="token number">9.8</span>
prob <span class="token operator">=</span> ODEProblem<span class="token punctuation">(</span>f<span class="token punctuation">,</span>u0<span class="token punctuation">,</span>tspan<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
sol <span class="token operator">=</span> solve<span class="token punctuation">(</span>prob<span class="token punctuation">,</span>Tsit5<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>callback<span class="token operator">=</span>cb<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>sol<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以得到如下结果：</p><figure><img src="`+o+`" alt="图 5" tabindex="0" loading="lazy"><figcaption>图 5</figcaption></figure><hr><p>如果考虑反弹损失（每次反弹速度损失20%）：</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code><span class="token keyword">function</span> affect<span class="token operator">!</span><span class="token punctuation">(</span>integrator<span class="token punctuation">)</span>
integrator<span class="token punctuation">.</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>integrator<span class="token punctuation">.</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">0.8</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+c+`" alt="图 6" tabindex="0" loading="lazy"><figcaption>图 6</figcaption></figure><p>也能够得到相应的结果，妙啊！！！</p><p>全部代码：</p><div class="language-julia line-numbers-mode" data-ext="julia"><pre class="language-julia"><code><span class="token keyword">using</span> DifferentialEquations<span class="token punctuation">,</span>Plots
<span class="token keyword">function</span> f<span class="token punctuation">(</span>du<span class="token punctuation">,</span> u<span class="token punctuation">,</span> p<span class="token punctuation">,</span> t<span class="token punctuation">)</span>
    du<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    du<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>p
<span class="token keyword">end</span>
<span class="token keyword">function</span> condition<span class="token punctuation">(</span>u<span class="token punctuation">,</span> t<span class="token punctuation">,</span> integrator<span class="token punctuation">)</span> <span class="token comment"># Event when event_f(u,t) == 0</span>
    u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
<span class="token keyword">function</span> affect<span class="token operator">!</span><span class="token punctuation">(</span>integrator<span class="token punctuation">)</span>
    integrator<span class="token punctuation">.</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>integrator<span class="token punctuation">.</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
cb <span class="token operator">=</span> ContinuousCallback<span class="token punctuation">(</span>condition<span class="token punctuation">,</span> affect<span class="token operator">!</span><span class="token punctuation">)</span>
u0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">50.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
tspan <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">15.0</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> <span class="token number">9.8</span>
prob <span class="token operator">=</span> ODEProblem<span class="token punctuation">(</span>f<span class="token punctuation">,</span> u0<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
sol <span class="token operator">=</span> solve<span class="token punctuation">(</span>prob<span class="token punctuation">,</span> Tsit5<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> callback<span class="token operator">=</span>cb<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>sol<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>!!! tip<br> DE中有许多特性，例如求解结果的处理（Solution Handle）、回调函数（Callback）等等。更多特性可以在官方文档中查看。</p>`,22),g=[u,r,m,k,d,b,h];function v(y,f){return p(),e("div",null,g)}const w=t(i,[["render",v],["__file","DE_intro.html.vue"]]);export{w as default};
